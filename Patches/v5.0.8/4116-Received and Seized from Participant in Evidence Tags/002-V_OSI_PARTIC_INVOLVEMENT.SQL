CREATE OR REPLACE VIEW V_OSI_PARTIC_INVOLVEMENT
(SID, PARTICIPANT_VERSION, OBJ, INVOLVEMENT_ROLE_SID, INVOLVEMENT_ROLE_CODE, INVOLVEMENT_ROLE_DESC, 
 NUM_BRIEFED, CREATE_BY, CREATE_ON, MODIFY_BY, MODIFY_ON, 
 ACTION_DATE, RESPONSE, RESPONSE_DATE, AGENCY_FILE_NUM, REPORT_TO_DIBRS, 
 REPORT_TO_NIBRS, REASON, 
 PARTICIPANT, 
 --PERSON_TYPE_CODE, 
 OBJECT_TYPE_DESC, 
 --PERSON_SUBTYPE_CODE, 
 --PERSON_SUBTYPE_DESC, 
 FULL_NAME, SEX_DESC, DOB, 
 --CURR_ADDR_STRING, 
 CURRENT_ADDRESS_DESC, 
 SSN, CO_CAGE, CO_DUNS, 
 ORG_HIGH_RISK, ORG_UIC, CONFIRMED, 
 --ORG_NAME, ORG_ADDR, 
 SA_SERVICE_DESC, SA_AFFILIATION_DESC, SA_COMPONENT_DESC, SA_PAY_PLAN_DESC, SA_PAY_GRADE_DESC, 
 SA_RANK, SA_RANK_DATE, SA_SPECIALTY_CODE, RACE_DESC, SA_RESERVIST)
AS 
select 
  PI.SID,
  PI.PARTICIPANT_VERSION,
  PI.OBJ,
  PI.INVOLVEMENT_ROLE,
  RT.CODE,
  RT.ROLE,
  PI.NUM_BRIEFED,
  PI.CREATE_BY,
  PI.CREATE_ON,
  PI.MODIFY_BY,
  PI.MODIFY_ON,
  PI.ACTION_DATE,
  PI.RESPONSE,
  PI.RESPONSE_DATE,
  PI.AGENCY_FILE_NUM,
  PI.REPORT_TO_DIBRS,
  PI.REPORT_TO_NIBRS,
  PI.REASON, 
  PV.PARTICIPANT, 
--  PV.PERSON_TYPE_CODE, 
  PV.OBJ_TYPE_DESC, 
--  PV.PERSON_SUBTYPE_CODE, 
--  PV.PERSON_SUBTYPE_DESC, 
  PV.FULL_NAME, 
  PV.SEX_DESC, 
  PV.DOB,
  CURRENT_ADDRESS_DESC, 
--  PERSON.ADDRESS( PV.SID, 'CURRENT_ML' ) as CURR_ADDR_STRING, 
--  PERSON.ADDRESS( PV.SID, 'CURRENT' ) as CURR_ADDR_LINE, 
--  PERSON.LATEST_NUMBER( PV.SID, 'SSN' ) as SSN,
  SSN, 
  PV.CO_CAGE, 
  PV.CO_DUNS, 
  PV.ORG_HIGH_RISK, 
  PV.ORG_UIC, 
  decode(P.CONFIRM_BY, null, 'not Confirmed', 'Confirmed') as CONFIRMED, 
--  PERSON.CURRENT_NAME(PERSON.LATEST_ORG(PV.SID)) as ORG_NAME, 
--  PERSON.ADDRESS(PERSON.LATEST_ORG(PV.SID), 'CURRENT_ML') as ORG_ADDR, 
  SA_SERVICE_DESC,
  SA_AFFILIATION_DESC,
  SA_COMPONENT_DESC,
  SA_PAY_PLAN_DESC,
  SA_PAY_GRADE_DESC,
--  DECODE(PV.SA_SERVICE, NULL, 'N/A', 'A', 'Army', 'N', 'Navy', 'F', 'Air Force', 'M', 'Marine Corps', 'C', 'Coast Guard', 'O', 'NOAA', 'H', 'Public Health', 'D', 'Dept of Defense', PV.SA_SERVICE) AS SA_SERVICE,
--  DECODE(PV.SA_AFFILIATION, NULL, 'N/A', 'ME', 'Member/Employee', 'CO', 'Contractor', 'SR', 'Service Retiree', 'SD', 'Service Dependent', PV.SA_AFFILIATION) AS SA_AFFILIATION, 
--  DECODE(PV.SA_COMPONENT, NULL, 'N/A', 'R', 'Regular', 'V', 'Reserve', 'G', 'National Guard', PV.SA_COMPONENT) AS SA_COMPONENT, 
--  DECODE(PV.SA_PAY_PLAN, NULL, 'N/A', 'EM', 'Enlisted', 'WM', 'Warrant Officer', 'OM', 'Commissioned Officer', 'CM', 'Cadet/Midshipman', 'ES', 'Executive Schedule', 'GS', 'General Schedule', 'WG', 'Wage Grade', PV.SA_PAY_PLAN) AS SA_PAY_PLAN, 
--  DECODE(PV.SA_PAY_GRADE, NULL, 'N/A', 'Grade ' || PV.SA_PAY_GRADE) AS SA_PAY_GRADE, 
  PV.SA_RANK, 
  PV.SA_RANK_DATE, 
  PV.SA_SPECIALTY_CODE, 
  PV.RACE_DESC, 
  PV.SA_RESERVIST 
from 
  T_OSI_PARTIC_INVOLVEMENT PI, 
  V_OSI_PARTICIPANT_VERSION PV, 
  T_OSI_PARTICIPANT P,
  T_OSI_PARTIC_ROLE_TYPE RT 
where PV.SID = PI.PARTICIPANT_VERSION 
  AND P.SID = PV.PARTICIPANT
  AND RT.SID=PI.INVOLVEMENT_ROLE
/
