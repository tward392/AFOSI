CREATE OR REPLACE VIEW V_OSI_PERSONNEL
(SID, SSN, LAST_NAME, FIRST_NAME, MIDDLE_NAME, 
 START_DATE, SEX, I2MS_LOGIN, PERSONNEL_NUM, BADGE_NUM, 
 PSWD, PSWD_EXPIRATION_DATE, BIRTH_DATE, ADDRESS, MARITAL_STATUS, 
 AF_ACCESSION_DATE, FRN, PERSONNEL_STATUS, STATUS_DATE, PAY_PLAN, 
 PAY_GRADE, PAY_CATEGORY, PAY_BAND, LEAP_AGENT, BIRTH_ADDR, 
 RACE, EYE_COLOR, HAIR_COLOR, HEIGHT, WEIGHT, 
 FORMAL_EDUCATION, UCO_INTEREST, UCO_AVAILABILITY_START_DATE, UCO_AVAILABILITY_END_DATE, GF_DEP_PTS, 
 GF_DEP_PTS_DATE, PROBATIONARY_AGENT, TECHNICAL_AGENT, EEP_AGENT, AD_USERNAME, 
 PERSONNEL_NAME, UNIT, UNIT_NAME, UNIT_CODE, POSITION, 
 FOREIGN_NATIONAL, CCI, CFFE, JDET_AGENT)
AS 
select
 CP.SID as SID, 
 OP.SSN as SSN, 
 CP.LAST_NAME as LAST_NAME, 
 CP.FIRST_NAME as FIRST_NAME, 
 CP.MIDDLE_NAME as MIDDLE_NAME,
 OP.START_DATE as START_DATE, 
 SEX.CODE as SEX, 
 CP.LOGIN_ID as I2MS_LOGIN, 
 --P.MODIFY_BY, P.MODIFY_ON,
 CP.PERSONNEL_NUM as PERSONNEL_NUM, 
 OP.BADGE_NUM as BADGE_NUM, 
 CP.PSWD as PSWD, 
 CP.PSWD_EXPIRATION_DATE as PSWD_EXPIRATION_DATE, 
 OP.BIRTH_DATE as BIRTH_DATE,
 osi_address.get_address_sid(cp.sid, 'PERM') ADDRESS,
 MS.CODE AS MARITAL_STATUS, 
 OP.AF_ACCESSION_DATE AS AF_ACCESSION_DATE, 
 OP.FRN AS FRN, 
 PS.CODE AS PERSONNEL_STATUS, 
 OP.PERSONNEL_STATUS_DATE AS PERSONNEL_STATUS_DATE, 
 PP.CODE as PAY_PLAN, 
 PG.CODE as  PAY_GRADE, 
 PCAT.CODE as PAY_CATEGORY, 
 PB.CODE as PAY_BAND, 
 OP.LEAP_AGENT as LEAP_AGENT,
 osi_address.get_address_sid(cp.sid, 'BIRTH') as BIRTH_ADDR, 
 RT.CODE as RACE,
 EC.DESCRIPTION as EYE_COLOR,
 HC.DESCRIPTION as HAIR_COLOR,
 PC.HEIGHT as HEIGHT,
 PC.WEIGHT as WEIGHT,
 PC.EDUCATION_LEVEL as FORMAL_EDUCATION, 
 OP.UCO_INTEREST as UCO_INTEREST, 
 OP.UCO_AVAILABILITY_START_DATE as UCO_AVAILABILITY_START_DATE, 
 OP.UCO_AVAILABILITY_END_DATE as UCO_AVAILABILITY_END_DATE,
 OP.GF_DEP_POINTS as GF_DEP_PTS, 
 OP.GF_DEP_POINT_DATE as GF_DEP_PTS_DATE, 
 OP.PROBATIONARY_AGENT as PROBATIONARY_AGENT, 
 OP.TECHNICAL_AGENT as TECHNICAL_AGENT, 
 OP.EEP_AGENT as EEP_AGENT, 
 OP.AD_USERNAME as AD_USERNAME,
 CP.LAST_NAME || ', ' || CP.FIRST_NAME || ' ' || CP.MIDDLE_NAME as PERSONNEL_NAME,
 H.UNIT as UNIT, 
 H.UNIT_NAME as UNIT_NAME, 
 H.UNIT_CODE as UNIT_CODE, 
 H.POSITION as POSITION, 
 OP.FOREIGN_NATIONAL as FOREIGN_NATIONAL, 
 OP.CCI as CCI, 
 OP.CFFE as CFFE,
 OP.JDET_AGENT as JDET_AGENT
from
  T_CORE_PERSONNEL CP,
  T_OSI_PERSONNEL OP,
  T_DIBRS_REFERENCE SEX,
  T_OSI_REFERENCE MS,
  T_OSI_REFERENCE PS,
  T_DIBRS_REFERENCE PP,
  T_DIBRS_PAY_GRADE_TYPE PG,
  T_OSI_REFERENCE PCAT,
  T_DIBRS_PAY_BAND_TYPE PB,
  T_DIBRS_RACE_TYPE RT,
  T_OSI_REFERENCE EC,
  T_OSI_REFERENCE HC,
  T_OSI_PERSON_CHARS PC,
  V_OSI_PERSONNEL_UNIT_A_HIST H
where
  CP.SID=OP.SID and
  PC.SEX=SEX.SID(+) and
  OP.MARITAL_STATUS=MS.SID(+) and
  OP.PERSONNEL_STATUS_SID=PS.SID(+) and
  PC.SA_PAY_PLAN=PP.SID(+) and
  PC.SA_PAY_GRADE=PG.SID(+) and
  OP.PAY_CATEGORY=PCAT.SID(+) and
  PC.SA_PAY_BAND=PB.SID(+) and
  PC.RACE=RT.SID(+) and
  PC.EYE_COLOR=EC.SID(+) and
  PC.HAIR_COLOR=HC.SID(+) and
  OP.SID=PC.SID(+) and
  H.PERSONNEL(+) = CP.SID and
  H.END_DATE(+) is null
/


